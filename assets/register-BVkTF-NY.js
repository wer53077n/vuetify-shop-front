import{aJ as S,a5 as M,a6 as _,w as l,az as A,o as B,b as r,aI as F,d as a,aG as n,av as x,R as V,a8 as f}from"./index-B6C-OAFi.js";import{c as U,a as u,f as q,u as N,e as m}from"./vee-validate.esm-BTG1ocXg.js";import{v as b}from"./index-BhZWKZOw.js";import{V as R,a as w}from"./VCol-BUbm-Whd.js";import{V as E}from"./VForm-Q1p4M4qT.js";import{V as P}from"./VRow--ZGpWkJM.js";const T=x("h1",{class:"text-center"},"註冊",-1),z={class:"text-center"},K={__name:"register",setup(G){const{api:y}=A(),C=S(),g=M(),h=U({account:u().required("使用者帳號必填").min(4,"使用者帳號長度不符").max(20,"使用者帳號長度不符").test("isAlphanumeric","使用者帳號格式錯誤",o=>b.isAlphanumeric(o)),email:u().required("使用者信箱必填").test("isEmail","使用者信箱格式錯誤",o=>b.isEmail(o)),password:u().required("使用者密碼必填").min(4,"使用者密碼長度不符").max(20,"使用者密碼長度不符"),passwordConfirm:u().oneOf([q("password")],"密碼不一致")}),{handleSubmit:k,isSubmitting:v}=N({validationSchema:h}),i=m("account"),d=m("email"),c=m("password"),p=m("passwordConfirm"),$=k(async o=>{var e,s;try{await y.post("/user",{account:o.account,email:o.email,password:o.password}),g({text:"註冊成功",snackbarProps:{color:"green"}}),C.push("/login")}catch(t){console.log(t),g({text:((s=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:s.message)||"發生錯誤",snackbarProps:{color:"red"}})}});return(o,e)=>(B(),_(R,null,{default:l(()=>[r(P,null,{default:l(()=>[r(w,{cols:"12"},{default:l(()=>[T]),_:1}),r(w,{cols:"12"},{default:l(()=>[r(E,{onSubmit:F(a($),["prevent"]),disabled:a(v)},{default:l(()=>[r(n,{label:"帳號",minlength:"4",maxlength:"20",counter:"",modelValue:a(i).value.value,"onUpdate:modelValue":e[0]||(e[0]=s=>a(i).value.value=s),"error-messages":a(i).errorMessage.value},null,8,["modelValue","error-messages"]),r(n,{label:"信箱",type:"email",modelValue:a(d).value.value,"onUpdate:modelValue":e[1]||(e[1]=s=>a(d).value.value=s),"error-messages":a(d).errorMessage.value},null,8,["modelValue","error-messages"]),r(n,{label:"密碼",type:"password",minlength:"4",maxlength:"20",counter:"",modelValue:a(c).value.value,"onUpdate:modelValue":e[2]||(e[2]=s=>a(c).value.value=s),"error-messages":a(c).errorMessage.value},null,8,["modelValue","error-messages"]),r(n,{label:"確認密碼",type:"password",minlength:"4",maxlength:"20",counter:"",modelValue:a(p).value.value,"onUpdate:modelValue":e[3]||(e[3]=s=>a(p).value.value=s),"error-messages":a(p).errorMessage.value},null,8,["modelValue","error-messages"]),x("div",z,[r(V,{type:"submit",color:"#971A07",loading:a(v),onClick:e[4]||(e[4]=s=>o.$emit("close-dialog"))},{default:l(()=>[f("登入")]),_:1},8,["loading"]),r(V,{type:"button",color:"gray",class:"ms-5",onClick:e[5]||(e[5]=s=>o.$emit("close-dialog"))},{default:l(()=>[f("取消")]),_:1})])]),_:1},8,["onSubmit","disabled"])]),_:1})]),_:1})]),_:1}))}};export{K as default};
